mu<-2
si<-0.6
bimodal<-c(rnorm(1000,-mu,si),rnorm(1000,mu,si)) 
uniform<-runif(2000,-4,4)
normal<-rnorm(2000,0,3)

pdf("inst/figures/comparison.pdf", width = 10)
par(mfrow = c(1,3))

labels <- c("bimodal", "uniform", "normal")

boxplot(bimodal,uniform,normal, names = c("", "", ""), main = "Box and Whisker")
text(x = 1:length(labels), y = par("usr")[3] - 1, srt = 45, adj = 1,
     labels = c("bimodal", "uniform", "normal"), xpd = TRUE)

vioplot(bimodal,uniform,normal, names = c("", "", ""))
title("Violin")
text(x = 1:length(labels), y = par("usr")[3] - 1, srt = 45, adj = 1,
     labels = c("bimodal", "uniform", "normal"), xpd = TRUE)

sina <- sinaplot(c(bimodal, uniform, normal), c(rep("bimodal", 2000), rep("uniform", 2000),
                                        rep("normal", 2000)), bw = TRUE, scale = F, plot = F)
plot(sina[[1]], xlim = c(0,4), xaxt = "n", xlab = "", ylab = "", main = "Sina", pch = 20)
axis(1, at = 1:3, labels = FALSE)
text(x = 1:length(labels), y = par("usr")[3] - 1, srt = 45, adj = 1,
     labels = c("bimodal", "uniform", "normal"), xpd = TRUE)
dev.off()

library(beeswarm)
sinaplot(df[,2], df[,1], ytitle = "log2 expression")


p1 <- ggplot(aes(V1, V2, fill = V1),data = df) + geom_boxplot() 
p1 <- p1 + theme(axis.text.x=element_blank()) + guides(fill=FALSE)
p1 <- p1 + ylab("log2 expression") + xlab("") + ggtitle("Box and Whisker")

p2 <- ggplot(aes(V1, V2, fill = "grey"),data = df) + geom_violin() + theme_bw()
p2 <- p2 + theme(axis.text.x=element_blank()) + guides(fill=FALSE) 
p2 <- p2 + ylab("") + xlab("") + ggtitle("Violin")

p3 <- sinaplot(df[,2], df[,1], size = 1.5) + ggtitle("Sina") + theme_bw()
p3 <- p3 + geom_point(colour="black") + theme(axis.text.x = element_blank()) + ylab("log2 expression")

beeswarm2 <- beeswarm(df[,2] ~ df[,1])
p4 <- ggplot(beeswarm2, aes(x, y)) + geom_point() + theme_bw()
#p4 <- ggplot(beeswarm2, aes(x, y)) + geom_point(aes(colour = df$V1)) + scale_x_discrete(limits = labels)
p4 <- p4 + theme(axis.text.x = element_blank()) + guides(colour=FALSE) 
p4 <- p4 + ylab("") + xlab("") + ggtitle("Bee Swarm")

p5 <- ggplot(dfjitter, aes(x, y)) + geom_point()


pdf("inst/figures/comparison.pdf", width = 12)
png("inst/figures/comparison.png")
grid.arrange(p1, p2, p4, p3, ncol = 2)
dev.off()
df[,1] <- factor(df[,1], levels = unique(df[,1]))
